namespace: fullstack

awsIam:
  customPolicy:
    Version: "2012-10-17"
    Statement:
      - Effect: Allow
        Action:
          - dynamodb:*
        Resource:
          - arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${param:userTable}
          - arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${param:postsTable}
containers:
  users-api:
    compute:
      src: ./user-api
      environment:
        SERVICE_NAME: user-api
        DEPLOYMENT_VERSION: v1.2
        USER_TABLE_NAME: ${param:userTable}
    routing:
      pathPattern: /api/users*
  posts-api:
    compute:
      src: ./posts-api
      environment:
        SERVICE_NAME: posts-api
        DEPLOYMENT_VERSION: v1.1
        POSTS_TABLE_NAME: ${param:postsTable}
    routing:
      pathPattern: /api/posts*
  ui:
    compute:
      src: ./ui
      type: awsFargate
      environment:
        SERVICE_NAME: ui
        DEPLOYMENT_VERSION: v1.1
    routing:
      pathPattern: /*
